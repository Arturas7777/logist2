{% extends "admin/base_site.html" %}
{% load static %}

{% block title %}–û–ø–ª–∞—Ç–∞ –∏–Ω–≤–æ–π—Å–∞ {{ invoice.number }}{% endblock %}

{% block content %}
<div style="max-width: 800px; margin: 20px auto;">
    <h1 style="margin-bottom: 20px;">üí≥ –û–ø–ª–∞—Ç–∞ –∏–Ω–≤–æ–π—Å–∞ {{ invoice.number }}</h1>
    
    <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –∏–Ω–≤–æ–π—Å–µ -->
    <div style="background: #f8f9fa; border: 1px solid #dee2e6; border-radius: 8px; padding: 20px; margin-bottom: 20px;">
        <h2 style="margin-top: 0;">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –∏–Ω–≤–æ–π—Å–µ</h2>
        
        <table style="width: 100%; border-collapse: collapse;">
            <tr>
                <td style="padding: 8px; font-weight: bold; width: 200px;">–ù–æ–º–µ—Ä –∏–Ω–≤–æ–π—Å–∞:</td>
                <td style="padding: 8px;">{{ invoice.number }}</td>
            </tr>
            <tr>
                <td style="padding: 8px; font-weight: bold;">–î–∞—Ç–∞:</td>
                <td style="padding: 8px;">{{ invoice.date|date:"d.m.Y" }}</td>
            </tr>
            <tr>
                <td style="padding: 8px; font-weight: bold;">–°—Ä–æ–∫ –æ–ø–ª–∞—Ç—ã:</td>
                <td style="padding: 8px;">
                    {{ invoice.due_date|date:"d.m.Y" }}
                    {% if invoice.is_overdue %}
                        <span style="color: #dc3545; font-weight: bold;">‚ö† –ü–†–û–°–†–û–ß–ï–ù</span>
                    {% endif %}
                </td>
            </tr>
            <tr>
                <td style="padding: 8px; font-weight: bold;">–ü–æ–ª—É—á–∞—Ç–µ–ª—å:</td>
                <td style="padding: 8px;">{{ invoice.recipient }}</td>
            </tr>
            <tr style="border-top: 2px solid #dee2e6;">
                <td style="padding: 12px 8px; font-weight: bold; font-size: 1.1em;">–ò—Ç–æ–≥–æ:</td>
                <td style="padding: 12px 8px; font-weight: bold; font-size: 1.2em;">{{ invoice.total }} ‚Ç¨</td>
            </tr>
            <tr>
                <td style="padding: 8px; font-weight: bold;">–û–ø–ª–∞—á–µ–Ω–æ:</td>
                <td style="padding: 8px; color: #28a745; font-weight: bold;">{{ invoice.paid_amount }} ‚Ç¨</td>
            </tr>
            <tr style="background: #fff3cd;">
                <td style="padding: 12px 8px; font-weight: bold; font-size: 1.1em;">–û—Å—Ç–∞—Ç–æ–∫:</td>
                <td style="padding: 12px 8px; color: #dc3545; font-weight: bold; font-size: 1.3em;">{{ remaining }} ‚Ç¨</td>
            </tr>
        </table>
    </div>
    
    <!-- –§–æ—Ä–º–∞ –æ–ø–ª–∞—Ç—ã -->
    <div style="background: white; border: 2px solid #007bff; border-radius: 8px; padding: 20px;">
        <h2 style="margin-top: 0; color: #007bff;">–û–ø–ª–∞—Ç–∏—Ç—å –∏–Ω–≤–æ–π—Å</h2>
        
        <form method="post" action="">
            {% csrf_token %}
            
            <div style="margin-bottom: 20px;">
                <label for="amount" style="display: block; font-weight: bold; margin-bottom: 5px;">
                    –°—É–º–º–∞ –ø–ª–∞—Ç–µ–∂–∞ (‚Ç¨):
                </label>
                <input 
                    type="number" 
                    id="amount" 
                    name="amount" 
                    step="0.01" 
                    min="0.01" 
                    max="{{ remaining }}"
                    value="{{ remaining }}"
                    required
                    style="width: 100%; padding: 10px; font-size: 1.1em; border: 2px solid #dee2e6; border-radius: 4px;"
                >
                <small style="color: #666;">–ú–∞–∫—Å–∏–º—É–º: {{ remaining }} ‚Ç¨</small>
            </div>
            
            <div style="margin-bottom: 20px;">
                <label for="method" style="display: block; font-weight: bold; margin-bottom: 5px;">
                    –°–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã:
                </label>
                <select 
                    id="method" 
                    name="method" 
                    required
                    style="width: 100%; padding: 10px; font-size: 1em; border: 2px solid #dee2e6; border-radius: 4px;"
                >
                    <option value="CASH">üíµ –ù–∞–ª–∏—á–Ω—ã–µ</option>
                    <option value="CARD">üí≥ –ë–∞–Ω–∫–æ–≤—Å–∫–∞—è –∫–∞—Ä—Ç–∞</option>
                    <option value="TRANSFER">üè¶ –ë–∞–Ω–∫–æ–≤—Å–∫–∏–π –ø–µ—Ä–µ–≤–æ–¥</option>
                    <option value="BALANCE">üí∞ –°–ø–∏—Å–∞–Ω–∏–µ —Å –±–∞–ª–∞–Ω—Å–∞</option>
                </select>
            </div>
            
            <div style="margin-bottom: 20px;">
                <label for="description" style="display: block; font-weight: bold; margin-bottom: 5px;">
                    –û–ø–∏—Å–∞–Ω–∏–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):
                </label>
                <textarea 
                    id="description" 
                    name="description" 
                    rows="3"
                    placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –û–ø–ª–∞—Ç–∞ –ø–æ –¥–æ–≥–æ–≤–æ—Ä—É ‚Ññ..."
                    style="width: 100%; padding: 10px; font-size: 1em; border: 2px solid #dee2e6; border-radius: 4px; resize: vertical;"
                ></textarea>
            </div>
            
            <div style="display: flex; gap: 10px; justify-content: flex-end;">
                <a 
                    href="{% url 'admin:core_newinvoice_change' invoice.id %}" 
                    class="button" 
                    style="padding: 12px 24px; background: #6c757d; color: white; text-decoration: none; border-radius: 4px; display: inline-block;"
                >
                    –û—Ç–º–µ–Ω–∞
                </a>
                <button 
                    type="submit" 
                    style="padding: 12px 24px; background: #28a745; color: white; border: none; border-radius: 4px; font-size: 1.1em; cursor: pointer; font-weight: bold;"
                >
                    ‚úì –û–ø–ª–∞—Ç–∏—Ç—å
                </button>
            </div>
        </form>
    </div>
    
    <!-- –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è -->
    {% if invoice.is_overdue %}
    <div style="background: #f8d7da; border: 2px solid #dc3545; border-radius: 8px; padding: 15px; margin-top: 20px;">
        <strong style="color: #721c24;">‚ö† –í–ù–ò–ú–ê–ù–ò–ï!</strong><br>
        –ò–Ω–≤–æ–π—Å –ø—Ä–æ—Å—Ä–æ—á–µ–Ω. –°—Ä–æ–∫ –æ–ø–ª–∞—Ç—ã –∏—Å—Ç–µ–∫ {{ invoice.due_date|date:"d.m.Y" }}.
    </div>
    {% endif %}
</div>
{% endblock %}

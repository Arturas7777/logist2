{% load i18n %}
<h3>{% blocktrans with filter_title=title %} By {{ filter_title }} {% endblocktrans %}</h3>
<ul>
    {% for choice in choices %}
        <li>
            <label>
                <input type="checkbox" 
                       name="{{ spec.parameter_name }}" 
                       value="{{ choice.value }}"
                       {% if choice.selected %}checked{% endif %}
                       id="status_{{ choice.value }}">
                {{ choice.display }}
            </label>
        </li>
    {% endfor %}
</ul>
<div style="margin-top: 8px; display: flex; gap: 6px;">
    <button type="button" onclick="applyFilter()" style="background: #6c5ce7; color: white; border: none; padding: 6px 14px; border-radius: 8px; cursor: pointer; font-size: .78rem; font-weight: 600; flex: 1;">
        Применить
    </button>
    <button type="button" onclick="clearFilter()" style="background: #ef4444; color: white; border: none; padding: 6px 14px; border-radius: 8px; cursor: pointer; font-size: .78rem; font-weight: 600; flex: 1;">
        Сбросить
    </button>
</div>

<script>
function applyFilter() {
    // Собираем все выбранные чекбоксы
    const checkboxes = document.querySelectorAll('input[name="{{ spec.parameter_name }}"]:checked');
    const values = Array.from(checkboxes).map(cb => cb.value);
    
    // Создаем новый URL с выбранными значениями
    const url = new URL(window.location);
    url.searchParams.delete('{{ spec.parameter_name }}');
    
    values.forEach(value => {
        url.searchParams.append('{{ spec.parameter_name }}', value);
    });
    
    // Переходим на новый URL
    window.location.href = url.toString();
}

function clearFilter() {
    // Создаем новый URL без параметров фильтра
    const url = new URL(window.location);
    url.searchParams.delete('{{ spec.parameter_name }}');
    
    // Переходим на новый URL
    window.location.href = url.toString();
}
</script>
